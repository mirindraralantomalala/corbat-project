<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Clients int√©ress√©s ‚Äî COR'BAT</title>
  <link rel="stylesheet" href="../css/style.css"/>
  <link rel="icon" type="image/png" href="../favicon.png">
  <style>
    /* Styles locaux pour la page leads */
    .container { max-width:1100px; margin:28px auto; font-family:'Poppins',sans-serif; }
    h1 { margin-bottom:16px; font-size:1.6rem; }
    .card { background:#fff; padding:16px; border-radius:10px; box-shadow:0 6px 20px rgba(2,6,23,0.06); }
    .controls { display:flex; gap:10px; align-items:center; margin-bottom:12px; }
    input#search { padding:10px; border-radius:8px; border:1px solid #e6e6e6; width:100%; max-width:420px; }
    select#filterStatus { padding:9px; border-radius:8px; border:1px solid #e6e6e6; }
    .btn-small { padding:8px 10px; border-radius:8px; background:#111; color:#fff; border:0; cursor:pointer; }
    table.table { width:100%; border-collapse:collapse; margin-top:12px; font-size:0.95rem; }
    table.table thead th { text-align:left; padding:10px; border-bottom:1px solid #f0f0f0; background:#fafafa; }
    table.table tbody td { padding:10px; border-bottom:1px solid #f8f8f8; vertical-align:middle; }
    .status-select { padding:6px 8px; border-radius:6px; border:1px solid #ddd; }
    .action-buttons button { margin-right:6px; }
    .muted { color:#777; font-size:0.9rem; }
    /* Modal details */
    .modal {
      position: fixed; inset:0; display:none; align-items:center; justify-content:center;
      background: rgba(0,0,0,0.5); z-index:9999; padding:20px;
    }
    .modal.active { display:flex; }
    .modal-panel {
      width:100%; max-width:720px; background:#fff; padding:22px; border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,0.25);
    }
    .modal-panel h3 { margin:0 0 8px 0; }
    .modal-row { display:flex; gap:12px; margin-bottom:8px; }
    .modal-row b { width:140px; color:#333; }
    .modal-close { float:right; background:transparent;border:0;font-size:20px;cursor:pointer;color:#666; }
    @media (max-width:700px){
      .modal-row { flex-direction:column; }
      .modal-row b { width:auto; }
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">
        <img src="../images/corbat.jpg" alt="Logo COR'BAT">
      </span> 
      <span class="brand-name">Admin COR'BAT</span>
    </div>
  
    <!-- Desktop menu -->
    <nav class="nav desktop-nav">
      <a href="dashboard.html" class="nav-link">Tableau de bord</a>
      <a href="devis.html" class="nav-link">Liste devis</a>
      <a href="leads.html" class="nav-link">Clients int√©ress√©s</a>
      <a href="projects.html" class="nav-link">Projets r√©cents</a>
      <a href="services.html" class="nav-link">Nos services</a>
      <a href="callbacks.html" class="nav-link">Demandes de rappel</a>
  
      <button id="btnLogout" class="btn-logout">Se d√©connecter</button>
    </nav>
  
    <!-- Bouton mobile -->
    <button class="menu-toggle" id="menuToggle" aria-label="Ouvrir le menu">‚ò∞</button>
  
    <!-- Overlay -->
    <div class="mobile-menu-overlay" id="mobileOverlay"></div>
  
    <!-- Mobile menu -->
    <nav class="mobile-nav" id="mobileMenu">
      <button class="close-menu" id="closeMenu">‚úï</button>
  
      <a href="dashboard.html" class="nav-link">Tableau de bord</a>
      <a href="devis.html" class="nav-link">Liste devis</a>
      <a href="leads.html" class="nav-link">Clients int√©ress√©s</a>
      <a href="projects.html" class="nav-link">Projets r√©cents</a>
      <a href="services.html" class="nav-link">Nos services</a>
      <a href="callbacks.html" class="nav-link">Demandes de rappel</a>
  
      <div class="admin-actions-mobile">
        <button id="btnLogoutMobile" class="btn-logout">Se d√©connecter</button>
      </div>
    </nav>
  </header>
  <!-- ======== STYLES (consolid√©s) ======== -->
  <style>
    /* Desktop */
    .nav {
      display: flex;
    }
    /* === Header moderne === */
    .topbar {
      display: flex;
      align-items: center;
      gap: 24px;
      padding: 18px 40px;
      background: #000;
      color: #fff;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 5px 25px rgba(0,0,0,0.1);
      font-family: 'Poppins', sans-serif;
    }

    /* Brand (logo + texte) */
    .brand {
      display: flex;
      align-items: center;
      gap: 16px; /* üëà ESPACE entre logo et texte */
      font-weight: 700;
      font-size: 1.2rem;
    }

    /* Conteneur du logo */
    .brand .logo {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff; /* fond blanc propre autour du logo */
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
    }

    /* Image du logo */
    .brand .logo img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* √©vite la d√©formation */
    }
    .brand .brand-name {
      font-size: 1.4rem;
      letter-spacing: 0.5px;
      background: #ffffff;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .actions button {
      border:0;
      border-radius:8px;
      padding:6px 8px;
      cursor:pointer;
      font-weight:700;
      margin-right:6px;
    }
    .actions .danger {
      background:red;
      color:#ffffff;
    }
    .brand img { width:50px; height:auto; }
    /* Nav align√©e √† droite */
    .desktop-nav {
      display: flex;
      gap: 28px;
      margin-left: auto;
      align-items: center;
    }
    .nav-link {
      text-decoration: none;
      color: #fff;
      font-weight: 500;
      position: relative;
      font-size: 1rem;
      transition: color 0.25s ease;
    }
    .nav-link::after {
      content: '';
      position: absolute;
      width: 0%;
      height: 2px;
      bottom: -6px;
      left: 0;
      background: linear-gradient(90deg,#ffb400,#ff6b6b);
      transition: width 0.25s ease;
    }
    .nav-link:hover {
      color: #ffb400;
    }
    .nav-link:hover::after {
      width: 100%;
    }
    /* Bouton Demander un devis */
    .btn-devis {
      padding: 8px 16px;
      border-radius: 22px;
      background: linear-gradient(90deg,#ffb400,#ff6b6b);
      color: #111;
      font-weight: 700;
      box-shadow: 0 6px 18px rgba(255,107,107,0.12);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .btn-devis:hover {
      transform: translateY(-2px);
    }
    /* Menu toggle (mobile) */
    .menu-toggle {
      display: none;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      margin-left: 12px;
    }
    .menu-toggle span {
      width: 26px;
      height: 3px;
      background: #fff;
      border-radius: 3px;
    }
    /* ===== Mobile menu admin ===== */
    .menu-toggle {
      background: none;
      border: none;
      font-size: 1.8rem;
      color: #fff;
      cursor: pointer;
      display: none;
    }

    .mobile-menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      opacity: 0;
      pointer-events: none;
      transition: 0.3s ease;
      z-index: 998;
    }

    .mobile-menu-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .mobile-nav {
      position: fixed;
      top: 0;
      right: -100%;
      width: 85%;
      max-width: 340px;
      height: 100vh;
      background: #000;
      display: flex;
      flex-direction: column;
      padding: 24px;
      gap: 8px;
      transition: 0.35s ease;
      z-index: 999;
    }

    .mobile-nav.active {
      right: 0;
    }

    .close-menu {
      background: none;
      border: none;
      color: #fff;
      font-size: 1.5rem;
      align-self: flex-end;
      cursor: pointer;
    }

    .mobile-nav .nav-link {
      font-size: 1.05rem;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    .admin-actions-mobile {
      margin-top: auto;
      display: flex;
      flex-direction: column;
    }

    @media (max-width: 900px) {
      .desktop-nav {
        display: none;
      }

      .menu-toggle {
        display: block;
      }
    }
  </style>

  <main class="container section">
    <h1>Liste des clients int√©ress√©s</h1>
  
    <div class="card" role="region" aria-label="Gestion des leads">
      <div class="controls" style="justify-content:space-between;gap:12px;flex-wrap:wrap;">
        <div style="display:flex;gap:8px;flex:1;min-width:260px;align-items:center">
          <input id="search" placeholder="Rechercher nom / email / service..." aria-label="Recherche leads">
          <!-- NOTE: value = cle technique (new/contacted/quoted/closed) -->
          <select id="filterStatus" aria-label="Filtrer par statut">
            <option value="">Tous statuts</option>
            <option value="Nouvelle">Nouvelle</option>
            <option value="Contact√©e">Contact√©e</option>
            <option value="R√©solue">R√©solue</option>
          </select>
        </div>
  
        <div style="display:flex;gap:8px;align-items:center">
        </div>
      </div>
  
      <table id="leadsTable" class="table" aria-live="polite">
        <thead>
          <tr>
            <th>Nom</th>
            <th>Email</th>
            <th>T√©l√©phone</th>
            <th>Service</th>
            <th>Date</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Rempli par ../js/admin.js (cl√© attendue : 'btp_leads') -->
        </tbody>
      </table>
      <div id="mobileLeads" class="mobile-leads"></div>
    </div>
  </main>
  <!-- Modal pour voir les d√©tails -->
  <div id="leadModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="leadModalTitle">
    <div class="modal-panel" role="document">
      <button class="modal-close" id="closeLeadModal" aria-label="Fermer">&times;</button>
      <h3 id="leadModalTitle">D√©tails du client int√©ress√©</h3>
      <div id="leadDetails" style="margin-top:12px"></div>
      <div style="margin-top:16px;text-align:right">
        <button id="closeLeadModal2" class="btn-small">Fermer</button>
      </div>
    </div>
  </div>
  
  <script>
    (async function(){
      const API_URL = "/api/leads";
      const tableBody = document.querySelector("#leadsTable tbody");
      const mobileContainer = document.getElementById("mobileLeads");
      const searchInput = document.getElementById("search");
      const filterStatus = document.getElementById("filterStatus");
      const exportBtn = document.getElementById("exportCsv");

      const safe = v => v || "-";
      const fmt = d => d ? new Date(d).toLocaleString("fr-FR") : "-";

      async function fetchLeads() {
        const res = await fetch(API_URL);
        if (!res.ok) throw new Error("Erreur serveur");
        return await res.json();
      }

      async function updateStatus(id, newStatus) {
        const res = await fetch(`${API_URL}/${id}/status`, {
          method: "PATCH",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ status: newStatus })
        });
        return res.ok;
      }

      async function deleteLead(id) {
        if (!confirm("Voulez-vous vraiment supprimer ce client ?")) return;
        const res = await fetch(`${API_URL}/${id}`, { method: "DELETE" });
        if (!res.ok) {
          alert("Erreur suppression");
          return;
        }
        alert("‚úÖ Client supprim√© !");
        render();
      }

      function bindEvents(leads) {
        // Boutons supprimer
        document.querySelectorAll(".danger").forEach(btn => {
          btn.onclick = () => deleteLead(btn.dataset.id);
        });

        // Boutons voir
        document.querySelectorAll(".view-btn").forEach(btn => {
          btn.onclick = () => {
            const lead = leads.find(l => l.id == btn.dataset.id);
            if (!lead) return alert("Client introuvable");
            showLeadModal(lead);
          };
        });

        // Select statut
        document.querySelectorAll(".status-select").forEach(sel => {
          sel.onchange = async () => {
            const ok = await updateStatus(sel.dataset.id, sel.value);
            if (ok) render();
          };
        });
      }

      async function render() {
        let leads = await fetchLeads();

        const search = searchInput.value.toLowerCase();
        const filter = filterStatus.value.toLowerCase();

        if (filter)
          leads = leads.filter(l => (l.status || "").toLowerCase() === filter);

        if (search)
          leads = leads.filter(l =>
            ((l.fullname||"") + (l.email||"") + (l.service||""))
              .toLowerCase()
              .includes(search)
          );

        // Desktop table
        if (!leads.length) {
          tableBody.innerHTML = `<tr><td colspan="7" style="padding:20px;text-align:center;color:#777;">Aucun client trouv√©.</td></tr>`;
          mobileContainer.innerHTML = "";
          return;
        }

        tableBody.innerHTML = leads.map(l => `
          <tr>
            <td>${safe(l.fullname)}</td>
            <td>${safe(l.email)}</td>
            <td>${safe(l.phone)}</td>
            <td>${safe(l.service)}</td>
            <td>${fmt(l.created_at)}</td>
            <td>
              <select class="status-select" data-id="${l.id}">
                <option value="Nouvelle" ${l.status==="Nouvelle"?"selected":""}>Nouvelle</option>
                <option value="Contact√©e" ${l.status==="Contact√©e"?"selected":""}>Contact√©e</option>
                <option value="R√©solue" ${l.status==="R√©solue"?"selected":""}>R√©solue</option>
              </select>
            </td>
            <td>
              <button class="btn-small view-btn" data-id="${l.id}">Voir</button>
              <button class="danger" data-id="${l.id}">Supprimer</button>
            </td>
          </tr>
        `).join("");

        // Mobile cards
        mobileContainer.innerHTML = leads.map(l => `
          <div class="lead-card">
            <div class="lead-row"><b>Nom</b><span>${safe(l.fullname)}</span></div>
            <div class="lead-row"><b>Email</b><span>${safe(l.email)}</span></div>
            <div class="lead-row"><b>T√©l√©phone</b><span>${safe(l.phone)}</span></div>
            <div class="lead-row"><b>Service</b><span>${safe(l.service)}</span></div>
            <div class="lead-row"><b>Date</b><span>${fmt(l.created_at)}</span></div>

            <select class="status-select" data-id="${l.id}">
              <option value="Nouvelle" ${l.status==="Nouvelle"?"selected":""}>Nouvelle</option>
              <option value="Contact√©e" ${l.status==="Contact√©e"?"selected":""}>Contact√©e</option>
              <option value="R√©solue" ${l.status==="R√©solue"?"selected":""}>R√©solue</option>
            </select>

            <div class="lead-actions">
              <button class="btn-small view-btn" data-id="${l.id}">Voir</button>
              <button class="danger" data-id="${l.id}">Supprimer</button>
            </div>
          </div>
        `).join("");

        bindEvents(leads);
      }

      function showLeadModal(lead){
        const modal = document.getElementById("leadModal");
        const target = document.getElementById("leadDetails");
        target.innerHTML = `
          <div><b>Nom :</b> ${safe(lead.fullname)}</div>
          <div><b>Email :</b> ${safe(lead.email)}</div>
          <div><b>T√©l√©phone :</b> ${safe(lead.phone)}</div>
          <div><b>Service :</b> ${safe(lead.service)}</div>
          <div><b>Statut :</b> ${safe(lead.status)}</div>
          <div><b>Date :</b> ${fmt(lead.created_at)}</div>
          <div style="margin-top:10px"><b>Message :</b><div style="white-space:pre-wrap">${safe(lead.message)}</div></div>
        `;
        modal.classList.add("active");
      }

      document.getElementById("closeLeadModal").onclick = () => leadModal.classList.remove("active");
      document.getElementById("closeLeadModal2").onclick = () => leadModal.classList.remove("active");

      searchInput.oninput = render;
      filterStatus.onchange = render;

      render();
    })();
    </script>
  
  <style>
    .danger {
      background: linear-gradient(135deg, #ff4d4d, #d60000);
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 6px 14px rgba(255,0,0,0.25);
      transition: all 0.2s ease;
    }

    .danger:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(255,0,0,0.35);
    }

    .danger:active {
      transform: scale(0.95);
    }

    /* ===== Responsive Table ===== */

    @media (max-width: 768px) {

    h1 {
      font-size: 1.3rem;
      margin-bottom: 14px;
    }

    .controls {
      flex-direction: column;
      align-items: stretch;
    }

    .controls > div {
      flex-direction: column;
      width: 100%;
    }

    #search, #filterStatus {
      width: 100%;
      padding: 12px;
      font-size: 15px;
    }

    /* Masquer le tableau */
    table {
      display: none;
    }

    /* Conteneur mobile */
    .mobile-leads {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .lead-card {
      background: #fff;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      border: 1px solid #eee;
    }

    .lead-row {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      font-size: 14px;
      margin-bottom: 6px;
    }

    .lead-row b {
      color: #555;
    }

    .lead-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    .lead-actions button {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      font-size: 14px;
    }

    .status-select {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
    }

    /* Modal mobile */
    .modal-panel {
      width: 95%;
      margin: 20px auto;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 16px;
    }

    }

    /* Desktop */
    .mobile-leads {
      display: none;
    }

    /* Mobile */
    @media (max-width: 768px) {
      table {
        display: none;
      }

      .mobile-leads {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .lead-card {
        background: #fff;
        padding: 14px;
        border-radius: 14px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      }

      .lead-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 6px;
      }

      .lead-actions {
        display: flex;
        gap: 8px;
        margin-top: 10px;
      }

      .lead-actions button {
        flex: 1;
        padding: 10px;
        border-radius: 10px;
      }

      .danger {
        width: 100%;
        padding: 12px;
        border-radius: 14px;
        font-size: 15px;
      }
    }
    .mobile-leads { display: none; }

    @media (max-width: 768px) {
      #leadsTable { display: none; }
      .mobile-leads { display: block; }
    }
  </style>
    <!-- ========== Admin Footer ========== -->
    <footer class="admin-footer" role="contentinfo" aria-label="Pied de page administration">
      <div class="admin-footer-inner">
        <div class="admin-left">
          <div class="admin-brand">
            <img src="../images/corbat.jpg" alt="COR'BAT" />
            <div>
              <strong>Admin COR'BAT</strong>
              <div class="small muted">Espace administrateur</div>
            </div>
          </div>
         
        </div>
    
        <div class="admin-right">
          <nav class="admin-links" aria-label="Liens utilitaires admin">
            <a href="dashboard.html" class="nav-link">Tableau de bord</a>
            <a href="devis.html" class="nav-link">Devis</a>
            <a href="leads.html" class="nav-link">Clients</a>
            <a href="projects.html" class="nav-link">Projets</a>
            <a href="services.html" class="nav-link">Services</a>
            <a href="callbacks.html" class="nav-link">Demande de rappel</a>
          </nav>
        </div>
      </div>
    
      <div class="admin-footer-bottom">
        <small>¬© <span id="adminYear"></span> COR'BAT ‚Äî Espace Admin ‚Ä¢ Tous droits r√©serv√©s.</small>
      </div>
    </footer>
    <!-- ====== Styles pour admin-footer ====== -->
    <style>
      .admin-footer {
        background:#070707;
        color:#e6e6e6;
        padding:18px 24px;
        border-top:1px solid rgba(255,255,255,0.04);
        font-family: 'Poppins', sans-serif;
        margin-top:32px;
      }
      .admin-footer-inner {
        display:flex;
        gap:20px;
        align-items:center;
        justify-content:space-between;
        flex-wrap:wrap;
      }
      .admin-left { display:flex; gap:14px; align-items:center; min-width:200px; }
      /* Conteneur logo admin */
      .admin-brand {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      /* Cercle autour du logo */
      .admin-brand img {
        width: 48px;
        height: 48px;
        border-radius: 50%;        /* üîµ rend le logo rond */
        object-fit: cover;         /* √©vite l‚Äô√©crasement */
        background: #fff;          /* fond propre autour */
        padding: 4px;              /* espace int√©rieur */
        box-shadow: 0 2px 8px rgba(0,0,0,0.25); /* effet moderne */
      }

      .admin-brand strong { display:block; color:#fff; }
      .small { font-size:0.87rem; }
      .muted { color:#a9a9a9; }
      .admin-center { flex:1; display:flex; justify-content:center; }
      .kpis { display:flex; gap:22px; align-items:center; }
      .kpi { text-align:center; min-width:88px; }
      .kpi-value { font-weight:700; font-size:1.25rem; color:linear-gradient(90deg,#ffb400,#ff6b6b); }
      .kpi-label { font-size:0.85rem; color:#bdbdbd; }
      .admin-right { display:flex; gap:14px; align-items:center; min-width:220px; justify-content:flex-end; }
      .admin-links { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
      .admin-links a { color:#dfe6ef; text-decoration:none; font-size:0.95rem; padding:6px 8px; border-radius:6px; }
      .admin-links a:hover { background:rgba(255,255,255,0.02); color:#fff; }
      .admin-actions { display:flex; gap:8px; align-items:center; }
      .btn-ghost.small { padding:6px 10px; background:transparent; color:#ccc; border:1px solid rgba(255,255,255,0.03); border-radius:8px; cursor:pointer; }
      .btn-logout { 
        background:#ef4444; 
        color:#ffffff; 
        border-radius:8px; 
        width: auto;              /* ‚ùå pas 100% */
        padding: 8px 14px;        /* taille compacte */
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        justify-content: center;
       }
      .admin-footer-bottom { text-align:center; margin-top:12px; color:#9a9a9a; font-size:0.88rem; border-top:1px solid rgba(255,255,255,0.02); padding-top:10px; }
      .dev-credit {
        position: fixed;
        bottom: 10px;
        right: 14px;
        font-size: 0.68rem;
        opacity: 0.25;
        color: #ffffff; /* si fond clair ‚Üí change en #555 */
        line-height: 1.25;
        text-align: right;
        transition: opacity 0.25s ease, transform 0.25s ease;
        z-index: 9999;
      }
      .dev-credit a {
        color: inherit;
        text-decoration: none;
      }
      .dev-credit:hover {
        opacity: 0.9;
        transform: translateY(-2px);
      }
/* =================== MOBILE =================== */
@media (max-width: 768px) {
  .admin-footer {
    padding: 18px 14px 22px;
  }

  .admin-footer-inner {
    flex-direction: column;
    align-items: stretch;
    gap: 16px;
  }

  .admin-left {
    flex-direction: column;
    gap: 10px;
  }

  .admin-right {
    justify-content: flex-start;
  }

  .admin-links {
    flex-direction: column;
    align-items: stretch;
  }

  .admin-links a {
    width: 100%;
    text-align: left;
    padding: 12px 14px;
    font-size: 1rem;
  }

  .admin-footer-bottom {
    font-size: 0.8rem;
  }

  .dev-credit {
    text-align: left;
    font-size: 0.75rem;
    opacity: 0.7;
  }
}
    </style>

    <script>
      (function(){
        // Mise √† jour de l'ann√©e footer
        document.getElementById('adminYear').textContent = new Date().getFullYear();
      
      // D√©connexion via backend (efface cookie)
      const btnLogout = document.getElementById('btnLogout');
      const btnLogoutMobile = document.getElementById('btnLogoutMobile');

      async function logout() {
        if(!confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) return;

        await fetch("/api/auth/logout", {
          method: "POST",
          credentials: "include"
        });

        localStorage.removeItem('btp_admin_logged');
        localStorage.removeItem('btp_admin_token');
        sessionStorage.removeItem('btp_admin_logged');
        sessionStorage.removeItem('btp_admin_token');

        window.location.href = "login.html";
      }

      if (btnLogout) {
        btnLogout.addEventListener('click', logout);
      }

      if (btnLogoutMobile) {
        btnLogoutMobile.addEventListener('click', logout);
      }
      
        // Bouton vider cache (ne touche pas l‚Äôauth)
        const btnClearCache = document.getElementById('btnClearCache');
        if (btnClearCache){
          btnClearCache.addEventListener('click', function(){
            if(!confirm('Vider les donn√©es d‚Äôimages ?')) return;
            localStorage.removeItem('projectImages');
            alert('Cache images supprim√©.');
            document.dispatchEvent(new Event('projectImagesCleared'));
          });
        }
      
      })();
    </script>
    <script>
      const menuToggle = document.getElementById("menuToggle");
      const mobileMenu = document.getElementById("mobileMenu");
      const closeMenu = document.getElementById("closeMenu");
      const overlay = document.getElementById("mobileOverlay");
      
      menuToggle.addEventListener("click", () => {
        mobileMenu.classList.add("active");
        overlay.classList.add("active");
      });
      
      closeMenu.addEventListener("click", closeMobileMenu);
      overlay.addEventListener("click", closeMobileMenu);
      
      function closeMobileMenu() {
        mobileMenu.classList.remove("active");
        overlay.classList.remove("active");
      }
    </script>
</body>
</html>
